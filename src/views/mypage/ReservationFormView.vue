<template>
    <div id="wrap">
        <AppHeader />
        <div id="reservationForm">
            <SideBar />
            <div class="container8">
                <h1>ÏòàÏïΩÌïòÍ∏∞</h1>

                <div>
                    <div class="managerInfor">
                        <div class="managerInfor2" style="display: flex">
                            <div>
                                <img  v-bind:src="`${this.$store.state.apiBaseUrl}/upload/${businessVo.logo}`"
                                    style="width: 220px;height: 220px; border-radius: 5%; border: 1px solid #a7a4a4;">
                            </div>

                            <div class="managerInfor3">
                                <label>Îß§Ïû•Î™Ö</label>
                                <p>{{ businessVo.title }}</p>
                                <label>Ï†ÑÌôîÎ≤àÌò∏</label>
                                <p>{{ businessVo.bPhone }}</p>
                                <label>Ïû•ÏÜå</label>
                                <p>{{ businessVo.bAddress }} {{ businessVo.bdAddress }}</p>
                                <label>ÌèâÍ∑†Î≥ÑÏ†ê</label>
                                <!-- <p>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê {{ businessVo.averageStar }}</p> -->

                                <p class="star" style="margin-top: 2px;">
                                    <!-- Full stars -->
                                    <span v-for="i in Math.floor(businessVo.averageStar)" :key="i"
                                        style="padding: none;"><img src="@/assets/images/star_yellow.jpg"
                                            style="width: 15px;"></span>
                                    <!-- Half star -->
                                    <span v-if="businessVo.averageStar - Math.floor(businessVo.averageStar) >= 0.5"><img
                                            src="@/assets/images/star_ban.png" style="width: 15px;"></span>
                                    <!-- Empty stars -->
                                    <span v-for="i in 5 - Math.ceil(businessVo.averageStar)" :key="'empty_' + i"><img
                                            src="@/assets/images/star_gray.jpg" style="width: 15px;"></span>
                                    {{ businessVo.averageStar }}
                                </p>


                            </div>
                        </div>
                    </div>

                </div>

                <div>
                    
                    <div class="buttonCon">
                        <button
                            :style="{ backgroundColor: currentStep >= 1 ? '#236c3f' : '', color: currentStep === 1 ? 'white' : '' }"
                            @click="setStep(1)"> <span :style="{ color: currentStep >= 1 ? 'white' : '' }">1. ÎÇ†Ïßú Î∞è
                                ÏãúÍ∞ÑÏÑ†ÌÉù</span></button>
                        <span>></span>
                        <button
                            :style="{ backgroundColor: currentStep >= 2 ? '#236c3f' : '', color: currentStep === 2 ? 'white' : '' }"
                            @click="setStep(2)"> <span :style="{ color: currentStep >= 2 ? 'white' : '' }">2. Î∞òÎ†§Í≤¨ Ï†ïÎ≥¥</span>
                        </button>
                        <span>></span>
                        <button
                            :style="{ backgroundColor: currentStep >= 3 ? '#236c3f' : '', color: currentStep === 3 ? 'white' : '' }"
                            @click="setStep(3)"> <span :style="{ color: currentStep >= 3 ? 'white' : '' }">3. ÎØ∏Ïö©ÏÑ†ÌÉù Î∞è ÏòàÏÉÅÍ∏àÏï°</span>
                        </button>
                        <span>></span>
                        <button
                            :style="{ backgroundColor: currentStep >= 4 ? '#236c3f' : '', color: currentStep === 4 ? 'white' : '' }"
                            @click="setStep(4)"> <span :style="{ color: currentStep >= 4 ? 'white' : '' }">4. Ï£ºÏùòÏÇ¨Ìï≠ Î∞è
                                ÎèôÏùòÏÑú</span> </button>

                    </div>


                    <form v-on:submit.prevent="reserveInsert">
                        <div>
                            <div v-if="currentStep == 1">
                                <div>
                                    <h2>üìÖ ÎÇ†ÏßúÏôÄ ÏãúÍ∞ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</h2>
                                </div>
                                <div class="choiceBox">
                                    <div class="calendar">
                                        <Datepicker @selectedDateTime="handleSelectedDateTime" />
                                    </div>
                                </div>

                                <div class="setstepBtnCon1" v-if="reserveVo.rtNo">
                                    <button @click="setStep(2)">ÏÑ†ÌÉù</button>
                                </div>

                            </div>
                            <div class="reservationBox">
                                <div v-if="currentStep == 2">
                                    <div style="display: flex">
                                        <div class="petChoice">
                                            <h2>üê∂ Î∞òÎ†§Í≤¨ÏÑ†ÌÉù</h2>

                                            <!-- <div class="petChoice" style="font-size: 16px; font-weight: bold">Î∞òÎ†§Í≤¨ ÏÑ†ÌÉù</div> -->
                                            <span v-for="dogVo in dogList" :key="dogVo.dogNo">
                                                <!-- {{ dogVo.dogNo }} -->
                                                <label :for="'pet-' + dogVo.dogNo">{{ dogVo.dogName }}</label>
                                                <input type="radio" name="pet" :id="'pet-' + dogVo.dogNo"
                                                    :value="dogVo.dogNo" @change="selectedDogClick"
                                                    v-model="selectedDog">
                                            </span>

                                        </div>

                                        <div class="character" v-if="dogVo.dogNo">
                                            <h2>üìù ÌäπÏù¥ÏÇ¨Ìï≠</h2>
                                            <button type="button"
                                                :style="{ backgroundColor: dogVo.skin ? '#236C3F' : 'white', color: dogVo.skin ? 'white' : 'black' }"
                                                @click="toggleSkinStatus">ÌîºÎ∂ÄÎ≥ë</button>
                                            <button type="button"
                                                :style="{ backgroundColor: dogVo.heart ? '#236C3F' : 'white', color: dogVo.heart ? 'white' : 'black' }"
                                                @click="toggleHeartStatus">Ïã¨Ïû•ÏßàÌôò</button>
                                            <button type="button"
                                                :style="{ backgroundColor: dogVo.marking ? '#236C3F' : 'white', color: dogVo.marking ? 'white' : 'black' }"
                                                @click="toggleMarkingStatus">ÎßàÌÇπ</button>
                                            <button type="button"
                                                :style="{ backgroundColor: dogVo.mounting ? '#236C3F' : 'white', color: dogVo.mounting ? 'white' : 'black' }"
                                                @click="toggleMountingStatus">ÎßàÏö¥ÌåÖ</button>


                                            <div class="bite">
                                                <div class="biteRange">
                                                    <label style="font-weight: bold;">ÏûÖÏßàÏ†ïÎèÑ</label>
                                                    <div class="biteRange2">

                                                        <input type="range" min="1" max="3" step="1" list="tickmarks"
                                                            v-model="dogVo.bite">
                                                        <datalist id="tickmarks">
                                                            <option value="1"></option>
                                                            <option value="2"></option>
                                                            <option value="3"></option>
                                                        </datalist>
                                                    </div>
                                                </div>
                                                <div class="pbox">
                                                    <p>Ìïò</p>
                                                    <p>Ï§ë</p>
                                                    <p>ÏÉÅ</p>
                                                </div>



                                            </div>
                                            <textarea placeholder="Í∏∞ÌÉÄ ÌäπÏù¥ÏÇ¨Ìï≠ÏùÑ Ï†ÅÏñ¥Ï£ºÏÑ∏Ïöî." v-model="dogVo.memo"></textarea>
                                        </div>
                                    </div>

                                    <div class="setstepBtnCon2" >
                                        <button class="setstepBtn1" @click="setStep(1)">Ïù¥Ï†ÑÏúºÎ°ú Ïù¥Îèô</button>
                                        <button v-if="dogVo.dogNo" @click="setStep(3)">ÏÑ†ÌÉù</button>
                                    </div>

                                </div>


                                <div v-if="currentStep == 3">
                                    <div class="price">
                                        <!-- {{ dogVo.size }} -->
                                        <p>Ìëú Î™©Î°ùÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.</p>
                                        <div class="tableBox">
                                            <!-- ÏÜåÌòïÍ≤¨ -->
                                            <table v-if="dogVo.size === 'ÏÜåÌòïÍ≤¨'" style="width: 650px;">
                                                <thead>
                                                    <tr>
                                                        <th>Î™∏Î¨¥Í≤å</th>
                                                        <th>Î™©Ïöï</th>
                                                        <th>Î∂ÄÎ∂Ñ</th>
                                                        <th>Î™©Ïöï+Î∂ÄÎ∂Ñ</th>
                                                        <th>ÏñºÍµ¥+Î∂ÄÎ∂Ñ+Î™©Ïöï</th>
                                                        <th colspan="2">Í∏∞Î≥∏Ï†ÑÏ≤¥ÎØ∏Ïö©</th>
                                                    </tr>
                                                </thead>
                                                <tbody v-for="(priceVo, i) in priceList" :key="i">
                                                    <tr v-if="i % 5 == 0">
                                                        <th>{{ priceVo.weightDiv }}</th>
                                                        <td :class="{ selected: selectedPriceIndex == i }"
                                                            @click="addPrice(priceVo.onePrice, i)">{{
                                    priceVo.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 1 }"
                                                            @click="addPrice(priceList[i + 1]?.onePrice, i + 1)">{{
                                    priceList[i
                                        +
                                        1]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 2 }"
                                                            @click="addPrice(priceList[i + 2]?.onePrice, i + 2)">{{
                                    priceList[i
                                        +
                                        2]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 3 }"
                                                            @click="addPrice(priceList[i + 3]?.onePrice, i + 3)">{{
                                    priceList[i
                                        +
                                        3]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 4 }"
                                                            @click="addPrice(priceList[i + 4]?.onePrice, i + 4)">{{
                                    priceList[i
                                        +
                                        4]?.onePrice.toLocaleString() }}</td>
                                                    </tr>
                                                </tbody>


                                            </table>

                                            <!-- Ï§ëÌòïÍ≤¨ -->
                                            <table v-if="dogVo.size === 'Ï§ëÌòïÍ≤¨'" style="width: 650px;">
                                                <thead>
                                                    <tr>
                                                        <th>Î™∏Î¨¥Í≤å</th>
                                                        <th>Î™©Ïöï</th>
                                                        <th>Î∂ÄÎ∂Ñ</th>
                                                        <th>Î™©Ïöï+Î∂ÄÎ∂Ñ</th>
                                                        <th>ÏñºÍµ¥+Î∂ÄÎ∂Ñ+Î™©Ïöï</th>
                                                        <th colspan="2">Í∏∞Î≥∏Ï†ÑÏ≤¥ÎØ∏Ïö©</th>
                                                    </tr>
                                                </thead>
                                                <tbody v-for="(priceVo, i) in priceList" :key="i">
                                                    <tr v-if="i % 5 == 0">
                                                        <th>{{ priceVo.weightDiv }}</th>
                                                        <td :class="{ selected: selectedPriceIndex == i }"
                                                            @click="addPrice(priceVo.onePrice, i)">{{
                                    priceVo.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 1 }"
                                                            @click="addPrice(priceList[i + 1]?.onePrice, i + 1)">{{
                                    priceList[i
                                        +
                                        1]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 2 }"
                                                            @click="addPrice(priceList[i + 2]?.onePrice, i + 2)">{{
                                    priceList[i
                                        +
                                        2]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 3 }"
                                                            @click="addPrice(priceList[i + 3]?.onePrice, i + 3)">{{
                                    priceList[i
                                        +
                                        3]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 4 }"
                                                            @click="addPrice(priceList[i + 4]?.onePrice, i + 4)">{{
                                    priceList[i
                                        +
                                        4]?.onePrice.toLocaleString() }}</td>
                                                    </tr>

                                                </tbody>


                                            </table>

                                            <!-- ÌäπÏàòÍ≤¨ -->
                                            <table v-if="dogVo.size == 'ÌäπÏàòÍ≤¨'">
                                                <thead>
                                                    <tr>
                                                        <th>Î™∏Î¨¥Í≤å</th>
                                                        <th>Î™©Ïöï</th>
                                                        <th>Î∂ÄÎ∂Ñ</th>
                                                        <th>Î™©Ïöï+Î∂ÄÎ∂Ñ</th>
                                                        <th>ÏñºÍµ¥+Î∂ÄÎ∂Ñ+Î™©Ïöï</th>
                                                        <th>Ïä§Ìè¨ÌåÖ</th>
                                                        <th>Í∞ÄÏúÑÏª∑</th>
                                                    </tr>
                                                </thead>
                                                <tbody v-for="(priceVo, i) in priceList" :key="i">
                                                    <tr v-if="i % 6 == 0">
                                                        <th>{{ priceVo.weightDiv }}</th>
                                                        <td :class="{ selected: selectedPriceIndex == i }"
                                                            @click="addPrice(priceList[i]?.onePrice, i)">{{
                                    priceVo.onePrice.toLocaleString()
                                }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 1 }"
                                                            @click="addPrice(priceList[i + 1]?.onePrice, i + 1)">{{
                                    priceList[i
                                        +
                                        1]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 2 }"
                                                            @click="addPrice(priceList[i + 2]?.onePrice, i + 2)">{{
                                    priceList[i
                                        +
                                        2]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 3 }"
                                                            @click="addPrice(priceList[i + 3]?.onePrice, i + 3)">{{
                                    priceList[i
                                        +
                                        3]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 4 }"
                                                            @click="addPrice(priceList[i + 4]?.onePrice, i + 4)">{{
                                    priceList[i
                                        +
                                        4]?.onePrice.toLocaleString() }}</td>
                                                        <td :class="{ selected: selectedPriceIndex == i + 5 }"
                                                            @click="addPrice(priceList[i + 5]?.onePrice, i + 5)">{{
                                    priceList[i
                                        +
                                                            5]?.onePrice.toLocaleString() }}</td>
                                                    </tr>
                                                </tbody>
                                            </table>


                                        </div>
                                        <table style="width: 650px;">
                                            <tbody>
                                                <tr>
                                                    <th rowspan="7">Ï∂îÍ∞ÄÏöîÍ∏à</th>
                                                </tr>
                                                <tr v-for="(priceList2, i) in priceList2" :key="i">
                                                    <th>{{ priceList2.beauty }}</th>
                                                    <td :class="{ 'selected': priceList2.selected }"
                                                        @click="toggleSelected(priceList2)">{{
                                                        priceList2.onePrice.toLocaleString()
                                                        }}</td>
                                                </tr>
                                            </tbody>
                                        </table>


                                    </div>


                                    <div class="expectPrice">
                                        <div> ÏòàÏÉÅÍ∞ÄÍ≤©</div>
                                        <div style="font-weight: bold;">{{ (this.reserveVo.expectedPrice -
                                            this.usePoint).toLocaleString()
                                            }}<span style=" font-weight: lighter; "> Ïõê</span></div>
                                    </div>

                                    <div class="setstepBtnCon3">
                                        <button class="setstepBtn1" @click="moveToStep(2)">Ïù¥Ï†ÑÏúºÎ°ú Ïù¥Îèô</button>
                                        <button  v-if="this.reserveVo.expectedPrice!==0" @click="moveToStep(4)">Îã§ÏùåÏúºÎ°ú Ïù¥Îèô</button>
                                    </div>

                                </div>

                                <div v-if="currentStep == 4">



                                    <div class="notice">
                                        <h2> ‚ö†Ô∏è ÏïàÎÇ¥ÏÇ¨Ìï≠ Î∞è ÎØ∏Ïö©Ïãú Ï£ºÏùòÏÇ¨Ìï≠</h2>
                                        <!-- <label for="notice">ÏïàÎÇ¥ÏÇ¨Ìï≠ Î∞è ÎØ∏Ïö©Ïãú Ï£ºÏùòÏÇ¨Ìï≠</label> -->
                                        <div id="notice">
                                            <strong>ÏïàÎÇ¥ÏÇ¨Ìï≠</strong><br>
                                            <p>1. ÎØ∏Ïö© ÌõÑ Ï∂îÍ∞Ä ÏöîÍ∏àÏù¥ Î∞úÏÉùÌï† Ïàò ÏûàÏäµÎãàÎã§. (ÏòàÏïΩÍ∏àÏ†úÏô∏)</p>
                                            <p>2. Ïã¨Ïû•Î≥ë/ÎãπÎá®/Í≥†ÌòàÏïï / Î∞úÏûë Îì±Ïùò ÏßÄÎ≥ë Í∏∞ÌÉÄ ÏÇ¨ÎÇòÏõÄ Îì±Ïùò ÏöîÏù∏ÏúºÎ°ú ÎØ∏Ïö©ÏùÑ Ï§ëÎã®Ìï† Ïàò ÏûàÏäµÎãàÎã§. Ïù¥Ïóê Ìï¥ÎãπÌïòÎäî Î∞òÎ†§Í≤¨ ÎØ∏Ïö© Ï§ë
                                                ÎòêÎäî
                                                ÎØ∏Ïö© ÌõÑ
                                                Î¨∏Ï†úÏãú
                                                Ï±ÖÏûÑÏùÑ
                                                ÏßÄÏßÄ ÏïäÏäµÎãàÎã§. (Ïù¥Î°úÏù∏Ìï¥ ÏßÄÎ∂àÌïú ÎØ∏Ïö©ÎπÑÎäî ÌôòÎ∂àÎêòÏßÄ ÏïäÏäµÎãàÎã§.)</p>
                                            <p>3. ÏÇ¨ÎÇòÏö¥ Î∞òÎ†§Í≤¨Ïùò Í≤ΩÏö∞ ÏÇ¨Ï†ÑÏóê ÏïåÎ†§Ï£ºÏãúÍ∏∞ Î∞îÎùºÎ©∞, ÎØ∏Ïö©ÏÇ¨Ïùò Î¨ºÎ¶º ÏÇ¨Í≥†Í∞Ä Î∞úÏÉùÏãú Î≥¥Ìò∏ÏûêÏóêÍ≤å ÏπòÎ£åÎπÑÎ•º Ï≤≠Íµ¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                                            <p>4. Ïù¥Îäî ÎßåÏùºÏùò ÏÉÅÌô©Ïóê ÎåÄÌïú ÎèôÏùòÏÑúÏù¥Îãà Í≤¨Ï£ºÏùò Ï∂©Î∂ÑÌïú Ïù¥Ìï¥ÏôÄ ÏñëÌï¥Î•º Î∂ÄÌÉÅÎìúÎ¶ΩÎãàÎã§.</p>
                                            <br>

                                            <strong>[ÎØ∏Ïö© ÌõÑ Ï£ºÏùòÏÇ¨Ìï≠]</strong>
                                            <p>1. ÏßßÏùÄ Í∏∞Í≥ÑÎØ∏Ïö©Í≥º ÎßéÏùÄ ÌÑ∏ ÏóâÌÇ¥Ïù¥ ÏûàÏùÑÏãú ÎØ∏Ïö© ÌõÑ ÏûêÍ∑πÏù¥ ÏôÄÏÑú Í∏ÅÍ±∞ÎÇò Ìï•ÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</p>
                                            <p> - Ïö∞Î¶¨ ÏïÑÍ∞ÄÎì§Ïùò ÌîºÎ∂ÄÎäî ÏÇ¨ÎûåÏóê ÎπÑÌï¥ ÏïΩÌïòÍ∏∞ ÎïåÎ¨∏Ïóê ÎØ∏Ïö© ÌõÑ Í∏ÅÍ±∞ÎÇò Ìï•ÏúºÎ©¥ ÏÉÅÏ≤òÍ∞Ä ÎÇòÍ±∞ÎÇò ÏßÑÎ¨º, Ïã¨ÌïòÎ©¥ ÌîºÍ∞Ä ÎÇ†ÏàòÏûàÏäµÎãàÎã§.
                                                Ïö∞Î¶¨ÏïÑÍ∞ÄÍ∞Ä ÏßÄÏÜçÏ†ÅÏúºÎ°ú Ìï•Í≥† Í∏ÅÍ∏∞ Ï†ÑÏóê Î®ºÏ†Ä ÏßÄÏºúÎ¥ê Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.</p>
                                            <p> 2. ÏùºÏãúÏ†ÅÏúºÎ°ú ÎØ∏Ïö© Ïä§Ìä∏Î†àÏä§Í∞Ä Ïò¨ Ïàò ÏûàÏúºÎÇò ÎåÄÎ∂ÄÎ∂Ñ 2~5Ïùº ÌõÑ Ï†êÏ∞® ÏÇ¨ÎùºÏßÄÍ≤å Îê©ÎãàÎã§.</p>
                                            <p> - Î∞•ÏùÑ Î®πÏßÄ ÏïäÍ±∞ÎÇò Íµ¨ÏÑùÏóê Ïà®Ïñ¥ÏûàÎäî Îã§Í±∞ÎÇò, Î∞∞Î≥ÄÏùÑ Î≥¥ÏßÄ ÏïäÎäî Îì± ÎØ∏Ïö© Ï†ÑÏóêÎäî ÏóÜÏóàÎçò ÌñâÎèôÏùÑ Î≥¥Ïùº Ïàò ÏûàÎãµÎãàÎã§.</p>
                                            <p> ÎØ∏Ïö©ÏùÑ Î∞òÎ≥µÌïòÎã§ Î≥¥Î©¥ Ï†êÏ∞® Ï¢ãÏïÑÏßÄÍ∏∞ÎèÑ Ìï©ÎãàÎã§. Ìëπ Ïâ¨Í≤å ÏïàÏ†ïÏùÑ Ï∑®Ìï¥Ï£ºÏãúÍ≥†, Ï¢ãÏïÑÌïòÎäî Í∞ÑÏãùÏùÑ Ï±ôÍ≤®Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.</p>
                                            <p> 3. Ìï≠Î¨∏ Ï£ºÏúÑÏùò ÌÑ∏ Ï†ïÎ¶¨ÏôÄ Ìï≠Î¨∏ÎÇ≠ Ï†úÍ±∞Î°ú ÏóâÎç©Ïù¥Î•º ÎÅåÍ≥† Îã§Îãê Ïàò ÏûàÏäµÎãàÎã§.</p>
                                            <p> 4. Ïù¥Ï§ëÎ™®(Ìè¨Î©îÎùºÎãàÏïà, Ïä§ÌîºÏ∏†, ÌèºÌîºÏ∏†, ÌéòÌÇ§, Ïõ∞Ïãú Îì±) ÏïÑÏù¥Îì§ÏùÄ ÌÅ¥Î¶¨ÌçºÎ°ú Î™∏ÏùÑ ÎØ∏Ïö©ÌñàÏùÑ Ïãú ÏïåÎ°úÌéòÏù¥ÏÇ¨Ï¶ùÌõÑÍµ∞Ïù¥ Ïò¨ Ïàò ÏûàÏúºÎ©∞,
                                            </p>
                                            <p>Í∑∏Î°úÏù∏Ìï¥ ÌÑ∏Ïù¥ ÎÇòÏßÄ ÏïäÏùÑ Ïàò ÏûàÏäµÎãàÎã§. Ïù¥Î•º ÏàôÏßÄÌïòÏãúÍ≥† ÏïÑÏù¥Îì§Ïùò ÎØ∏Ïö©Ïä§ÌÉÄÏùºÏùÑ Í≤∞Ï†ïÌï¥Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.</p>
                                            <p> - Í∞ÄÍ∏âÏ†Å Í∞ÄÏúÑÏª∑ Ï∂îÏ≤úÎìúÎ¶ΩÎãàÎã§.</p>
                                            <p>5. ÌèâÏÜåÏóî ÌÑ∏Ïóê Í∞ÄÎ†§Ï†∏ Î≥¥Ïù¥ÏßÄ ÏïäÏïòÎçò ÌîºÎ∂ÄÎ≥ëÏù¥ ÎØ∏Ïö© ÌõÑÏóê Î∞úÍ≤¨Îê† Ïàò ÏûàÏäµÎãàÎã§.</p>
                                            <p> 6. Í∑Ä ÏßàÌôòÏù¥ÎÇò ÌîºÎ∂Ä ÏßàÌôòÏù¥ ÏûàÎäî Í≤ΩÏö∞Îäî Î∞òÎìúÏãú Î≥ëÏõê ÏπòÎ£åÎ•º Î∞õÍ∏∏ Î∞îÎûçÎãàÎã§.</p>
                                            <p> 7. ÏÉùÏãùÍ∏∞ Î∞è Í∑ÄÌÑ∏ Ï†úÍ±∞ÏóêÏÑú ÏûêÍ∑πÏùÑ ÏµúÏÜåÌôîÌïòÍ∏∞ ÏúÑÌï¥ ÏßÄÏ†ÄÎ∂ÑÌï¥ Î≥¥Ïùº Ïàò ÏûàÎäî Ï†ê ÏñëÌï¥ Î∂ÄÌÉÅÎìúÎ¶ΩÎãàÎã§.</p>
                                        </div>
                                        <div class="agreeCheckboxCon">
                                            <input type="checkbox" id="agreeCheckbox"><label for="agreeCheckbox">ÏïàÎÇ¥ÏÇ¨Ìï≠ Î∞è
                                                ÎØ∏Ïö©Ïãú
                                                Ï£ºÏùòÏÇ¨Ìï≠Ïóê ÎèôÏùòÌï©ÎãàÎã§.</label>
                                        </div>
                                    </div>

                                    <div class="signBox">
                                        <h2> üñäÔ∏è Ï†ÑÏûêÏÑúÎ™Ö </h2>
                                        <div class="sign">
                                            <div>
                                                <canvas ref="signatureCanvas" v-on:mousedown="onBegin"
                                                    v-on:mouseup="onEnd" width="875" height="250"
                                                    style="border: 1px solid #000;">
                                                </canvas>
                                            </div>
                                            <div class="sign0">
                                                <button @click.prevent="clearCanvas">ÏßÄÏö∞Í∏∞</button>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="cal">
                                        <p>ÎÖ∏ÏáºÎ∞©ÏßÄÎ•º ÏúÑÌï¥ ÏòàÏïΩÍ∏à 20,000ÏõêÏùÑ Î∞õÍ≥† ÏûàÏäµÎãàÎã§.</p>
                                        <button type="button" v-for="(payment, index) in paymentMethods" :key="index"
                                            @click="togglePayment(index)"
                                            :class="{ 'selected': selectedPayment === index }">
                                            {{ payment }}
                                        </button>
                                    </div>


                                    <div class="point">
                                        <label>Ìè¨Ïù∏Ìä∏</label>
                                        <input type="number" step="10" v-model="usePoint">
                                        <button type="button" @click="useAllPoint">Ï†ÑÏï°ÏÇ¨Ïö©</button>
                                        <p>{{ (this.uPoint - this.usePoint).toLocaleString() }}P ÏÇ¨Ïö©Í∞ÄÎä•</p>
                                    </div>


                                    <div class="setstepBtnCon4">
                                        <button class="setstepBtn1" @click="setStep(3)">Ïù¥Ï†ÑÏúºÎ°ú Ïù¥Îèô</button>
                                        <button class="reserveInsert" type="submit">ÏòàÏïΩ</button>
                                    </div>
                                </div>





                            </div>
                        </div>
                    </form>
                </div>

            </div>
        </div>


        <TopButton />
        <AppFooter />
    </div><!-- wrap -->
</template>

<script>
import AppFooter from "@/components/AppFooter.vue"
import AppHeader from "@/components/AppHeader.vue"
import SignaturePad from 'signature_pad';
import axios from "axios"
import { mapActions } from 'vuex';
import '@/assets/css/mypage/mypage.css'
import Datepicker from '@/components/DatePicker.vue'
import SideBar from '@/components/SideBar.vue'
import TopButton from "@/components/TopButton.vue"






export default {
    name: "ReservationFormView",
    components: {
        AppHeader,
        AppFooter,
        Datepicker,
        SideBar,
        TopButton,

    },
    data() {
        return {
            currentStep: 1,
            selectedPriceIndex: null,
            signaturePad: null,
            reserveList: [],
            // Í≥†Í∞ù
            reserveVo: {
                rsNo: 0,
                bNo: this.$route.params.bNo,
                dogNo: 0,
                rtDate: "",
                rtTime: "",
                singImg: "",
                expectedPrice: 0,
                attitude: "",
                rContdition: "",
                tangle: "",
                disliked: "",
                bath: "",
                surcharge: 0,
                message: "",
                curruntWeight: 0,
                rtNo: 0,
                rtFinish: false,
            },
            // ÏÇ¨ÏóÖÏûê
            businessVo: {
                saveName: "",
                bNo: this.$route.params.bNo,
                title: "",
                bPhone: "",
                bAddress: "",
                bdAddress: "",
                averageStar: 0.0,
                rtDate: "",
                rsTime: "",
            },
            dogList: [],
            dogVo: {
                uNo: this.$store.state.authUser.uNo,
                dogNo: "",
                dogName: "",
                neutering: false,
                experience: false,
                bite: 0,
                memo: "",
                size: "",
                skin: false,
                heart: false,
                marking: false,
                mounting: false,
            },
            priceList: [],
            priceList2: [],
            priceVo: {
                priceNo: 0,
                beautyNo: 0,
                bNo: this.$route.params.bNo,
                onePrice: 0,
                sizeDiv: "",
                weightDiv: "",
                beauty: "",
                beauty2: [],
                priceNo2: [],
            },
            // Ïú†Ï†Ä
            uNo: this.$store.state.authUser.uNo,
            uPoint: 0,
            isClicked: false,    //Ìè¨Ïù∏Ìä∏Î≤ÑÌäº
            usePoint: 0,
            paymentMethods: ['Ìú¥ÎåÄÌè∞', 'Î¨¥ÌÜµÏû•ÏûÖÍ∏à'], // ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Í≤∞Ï†ú Î∞©Î≤ï
            selectedPayment: null, // ÏÑ†ÌÉùÎêú Í≤∞Ï†ú Î∞©Î≤ï Ïù∏Îç±Ïä§
            bNo:this.$route.params.bNo,

            

        };
    },

    watch: {
        currentStep(newVal) {
            if (newVal === 4) {
                this.initSignaturePad();
            }
        }
    },

    methods: {

        setStep(step) {
            this.currentStep = step;
        },
        moveToStep(step) {
            this.currentStep = step;
        },

        //Í∞ÄÍ≤åÏ†ïÎ≥¥
        getBList() {
            console.log("Í∞ÄÍ≤åÏ†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞");
            console.log(this.businessVo);
            let bNo = this.businessVo.bNo;
            axios({
                method: 'get',  //put,post,delete
                url: `${this.$store.state.apiBaseUrl}/api/mypage/getbList`,
                headers: { "Content-Type": "application/json; charset=utf-8" }, //Ï†ÑÏÜ°ÌÉÄÏûÖ
                params: { bNo: bNo },
                responseType: 'json' //ÏàòÏã†ÌÉÄÏûÖ
            }).then(response => {
                console.log("ÏÑ±Í≥µ");
                console.log(response.data.apiData); //ÏàòÏã†Îç∞Ïù¥ÌÉÄ
                this.businessVo = response.data.apiData;

                console.log(this.businessList);
            }).catch(error => {
                console.log(error);
            });
        },

        // ÎÇ†Ïßú ÏãúÍ∞Ñ
        handleSelectedDateTime(selected) {
            // ÏÑ†ÌÉùÌïú ÎÇ†ÏßúÏôÄ ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Î•º Î∞õÏïÑÏÑú Ï≤òÎ¶¨Ìï©ÎãàÎã§.
            console.log("Í≥ºÏó∞?????????????????????");
            console.log('ÏÑ†ÌÉùÌïú ÎÇ†Ïßú:', selected.newDate);
            console.log('ÏÑ†ÌÉùÌïú ÏãúÍ∞Ñ:', selected.time);
            console.log('ÏÑ†ÌÉùÌïú ÏãúÍ∞Ñ rtNo:', selected.rtNo);
            this.reserveVo.rtDate = selected.newDate;
            this.reserveVo.rtTime = selected.time;
            this.reserveVo.rtNo = selected.rtNo;



        },


        // Î∞òÎ†§Í≤¨ÏÑ†ÌÉù
        getPetList() {
            console.log("ÎÇ¥ Î∞òÎ†§Í≤¨ Í∞ÄÏ†∏Ïò§Í∏∞");
            // console.log(this.dogVo)
            console.log(this.dogVo.uNo);
            axios({
                method: 'get',  //put,post,delete
                url: `${this.$store.state.apiBaseUrl}/api/mypage/getpetlist`,
                headers: { "Content-Type": "application/json; charset=utf-8" }, //Ï†ÑÏÜ°ÌÉÄÏûÖ
                params: { uNo: this.dogVo.uNo },
                responseType: 'json' //ÏàòÏã†ÌÉÄÏûÖ
            }).then(response => {
                console.log("Î∞òÎ†§Í≤¨ÏÑ±Í≥µ");
                console.log(response.data.apiData); //ÏàòÏã†Îç∞Ïù¥ÌÉÄ

                this.dogList = response.data.apiData;

                // Ï¥àÍ∏∞Ìôî
                this.addPrice();
                this.reserveVo.expectedPrice = 0;
                this.priceList.forEach(item => {
                    item.selected = false;
                });



            }).catch(error => {
                console.log(error);
            });
        },




        // Î∞òÎ†§Í≤¨Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
        selectedDogClick() {
            console.log(this.selectedDog);
            axios({
                method: 'get',  //put,post,delete
                url: `${this.$store.state.apiBaseUrl}/api/mypage/getpetinfor`,
                headers: { "Content-Type": "application/json; charset=utf-8" }, //Ï†ÑÏÜ°ÌÉÄÏûÖ
                params: { dogNo: this.selectedDog },
                responseType: 'json' //ÏàòÏã†ÌÉÄÏûÖ
            }).then(response => {
                console.log("ÏÑ±Í≥µ");
                console.log(response.data.apiData); //ÏàòÏã†Îç∞Ïù¥ÌÉÄ
                this.dogVo = response.data.apiData;



                // Ï¥àÍ∏∞Ìôî
                this.getPrice();
                this.getPlusPrice();
                this.reserveVo.expectedPrice = 0;
                this.priceVo.beauty2 = [];
                this.addPrice();


            }).catch(error => {
                console.log(error);
            });
        },

        // ÌäπÏù¥ÏÇ¨Ìï≠ Î≤ÑÌäº
        toggleSkinStatus() {
            this.dogVo.skin = !this.dogVo.skin; // ÌîºÎ∂ÄÎ≥ë ÏÉÅÌÉú ÌÜ†Í∏Ä
        },
        toggleHeartStatus() {
            this.dogVo.heart = !this.dogVo.heart; // Ïã¨Ïû•ÏßàÌôò ÏÉÅÌÉú ÌÜ†Í∏Ä
        },
        toggleMarkingStatus() {
            this.dogVo.marking = !this.dogVo.marking; // ÎßàÌÇπ ÏÉÅÌÉú ÌÜ†Í∏Ä
        },
        toggleMountingStatus() {
            this.dogVo.mounting = !this.dogVo.mounting;
        },


        // Í∞ÄÍ≤©ÌëúÍ∞ÄÏ†∏Ïò§Í∏∞
        getPrice() {
            console.log("Í∞ÄÍ≤©Ìëú Í∞ÄÏ†∏Ïò§Í∏∞");
            console.log("ÏÇ¨ÏóÖÏûêÎ≤àÌò∏ : ", this.priceVo.bNo);
            console.log("ÌÅ¨Í∏∞ : ", this.dogVo.size);
            axios({
                method: 'get',  //put,post,delete
                url: `${this.$store.state.apiBaseUrl}/api/mypage/getprice`,
                headers: { "Content-Type": "application/json; charset=utf-8" }, //Ï†ÑÏÜ°ÌÉÄÏûÖ
                params: { bNo: this.priceVo.bNo, sizeDiv: this.dogVo.size },
                responseType: 'json' //ÏàòÏã†ÌÉÄÏûÖ
            }).then(response => {
                console.log("Í∞ÄÍ≤©Í∞ÄÏ†∏Ïò§Í∏∞ÏÑ±Í≥µ");
                console.log(response.data.apiData); //ÏàòÏã†Îç∞Ïù¥ÌÉÄ
                this.priceList = response.data.apiData;

            }).catch(error => {
                console.log(error);
            });
        },

        // Ï∂îÍ∞ÄÏöîÍ∏àÍ∞ÄÏ†∏Ïò§Í∏∞
        getPlusPrice() {
            console.log("Í∞ÄÍ≤©Ìëú-Ï∂îÍ∞ÄÏöîÍ∏à Í∞ÄÏ†∏Ïò§Í∏∞");
            axios({
                method: 'get',  //put,post,delete
                url: `${this.$store.state.apiBaseUrl}/api/mypage/getplusprice`,
                headers: { "Content-Type": "application/json; charset=utf-8" }, //Ï†ÑÏÜ°ÌÉÄÏûÖ
                params: { bNo: this.priceVo.bNo },
                responseType: 'json' //ÏàòÏã†ÌÉÄÏûÖ
            }).then(response => {
                console.log("Í∞ÄÍ≤©Ìëú-Ï∂îÍ∞ÄÏöîÍ∏à Í∞ÄÏ†∏Ïò§Í∏∞");
                console.log(response.data.apiData); //ÏàòÏã†Îç∞Ïù¥ÌÉÄ
                this.priceList2 = response.data.apiData;

            }).catch(error => {
                console.log(error);
            });
        },

        // Ï∂îÍ∞ÄÏöîÍ∏à Í∞ÄÍ≤©Ìëú
        toggleSelected(priceList2) {
            // ÏÑ†ÌÉù ÏÉÅÌÉúÎ•º ÌÜ†Í∏ÄÌï©ÎãàÎã§.
            priceList2.selected = !priceList2.selected;

            if (priceList2.selected) {
                console.log('ÏÑ†ÌÉùÌïú Í∞í :', priceList2.onePrice);
                this.reserveVo.expectedPrice += priceList2.onePrice; // ÏÑ†ÌÉùÌïú Í∞íÏùò ÎàÑÏ†ÅÏùÑ ÏàòÌñâÌï©ÎãàÎã§.

                // Í∞ÄÍ≤©Ìëú No Ï∂úÎ†• Î∞è Ï∂îÍ∞Ä
                console.log("priceNo:", priceList2.priceNo);
                this.priceVo.priceNo2.push(priceList2.priceNo); // priceNo2 Î∞∞Ïó¥Ïóê Ï∂îÍ∞ÄÌï©ÎãàÎã§.

                // ÏÑ†ÌÉùÌïú tdÏùò Í∞ÄÎ°úÏùò th Í∞íÏùÑ Í∞ÄÏ†∏ÏòµÎãàÎã§.
                const thValue = priceList2.beauty;
                console.log('ÏÑ†ÌÉùÌïú tdÏùò Í∞ÄÎ°úÏùò th Í∞í:', thValue);
                this.priceVo.beauty2.push(thValue);
                console.log(this.priceVo.beauty2);

            } else {
                console.log('ÏÑ†ÌÉù Ï∑®ÏÜåÌïú Í∞í :', priceList2.onePrice);
                this.reserveVo.expectedPrice -= priceList2.onePrice; // ÏÑ†ÌÉù Ï∑®ÏÜåÌïú Í∞íÏùò Ï∞®Í∞êÏùÑ ÏàòÌñâÌï©ÎãàÎã§.

                // ÏÑ†ÌÉù Ï∑®ÏÜåÌïú th Í∞íÏùÑ beauty2 Î∞∞Ïó¥ÏóêÏÑú Ï†úÍ±∞Ìï©ÎãàÎã§.
                const thIndex = this.priceVo.beauty2.indexOf(priceList2.beauty);
                if (thIndex > -1) {
                    this.priceVo.beauty2.splice(thIndex, 1);
                }

                // ÏÑ†ÌÉù Ï∑®ÏÜåÌïú priceNo Í∞íÏùÑ priceNo2 Î∞∞Ïó¥ÏóêÏÑú Ï†úÍ±∞Ìï©ÎãàÎã§.
                const priceNoIndex = this.priceVo.priceNo2.indexOf(priceList2.priceNo);
                if (priceNoIndex > -1) {
                    this.priceVo.priceNo2.splice(priceNoIndex, 1);
                }
            }

            // ÏΩòÏÜîÏóê ÌòÑÏû¨ ÏòàÏÉÅ Í∞ÄÍ≤© Ï∂úÎ†•
            console.log('ÌòÑÏû¨ ÏòàÏÉÅ Í∞ÄÍ≤© :', this.reserveVo.expectedPrice);
            // ÏΩòÏÜîÏóê ÌòÑÏû¨ priceNo2 Î∞∞Ïó¥ Ï∂úÎ†•
            console.log('ÌòÑÏû¨ priceNo Î∞∞Ïó¥ :', this.priceVo.priceNo2);
        }

        ,


        addPrice(price, index) {
            console.log("Í∞ÄÍ≤©ÏòàÏÉÅÌÅ¥Î¶≠");
            console.log("ÏÑ†ÌÉùÌïú Í∞ÄÍ≤©:", price);
            console.log("ÏÑ†ÌÉùÌïú Í∞ÄÍ≤©Ïùò Ïù∏Îç±Ïä§:", index);
            // ÏÑ†ÌÉùÌïú tdÏùò Ïó¥ Ïù∏Îç±Ïä§ Í≥ÑÏÇ∞
            const colIndex = event.target.cellIndex;

            // table ÏöîÏÜå Í∞ÄÏ†∏Ïò§Í∏∞
            const table = event.target.closest('table');

            // ÏÑ†ÌÉùÎêú tdÏôÄ ÎèôÏùºÌïú Ïó¥Ïóê ÏûàÎäî theadÏùò th ÏöîÏÜå Í∞ÄÏ†∏Ïò§Í∏∞
            const theadTh = table.querySelector('thead th:nth-child(' + (colIndex + 1) + ')');

            // ÏÑ†ÌÉùÎêú tdÏùò Ïó¥Ïóê ÏûàÎäî theadÏùò thÏùò ÎÇ¥Ïö© Í∞ÄÏ†∏Ïò§Í∏∞
            const firstThValue = theadTh.textContent;

            console.log("ÏÑ†ÌÉùÌïú tdÏùò Ï†ÑÏ≤¥ ÏÑ∏Î°úÏùò Ï≤´Î≤àÏß∏ th Í∞í:", firstThValue);

            // ÏÑ†ÌÉùÌïú ÌñâÏùò Ïù∏Îç±Ïä§ Í≥ÑÏÇ∞
            const rowIndex = Math.floor(index / 5) * 5;

            // ÏÑ†ÌÉùÌïú ÌñâÏùò Ï≤´ Î≤àÏß∏ Ïó¥Ïùò th Í∞í
            const thValue = this.priceList[rowIndex + 1].weightDiv;

            console.log("ÏÑ†ÌÉùÌïú ÌñâÏùò Ï≤´ Î≤àÏß∏ Ïó¥Ïùò th Í∞í:", thValue);
            console.log(this.priceVo.priceNo);


            // ÎßåÏïΩ Ïù¥ÎØ∏ ÏÑ†ÌÉùÎêú Í∞ÄÍ≤© Ìï≠Î™©Ïù¥Î©¥ ÏÑ†ÌÉù Ìï¥Ï†ú
            if (this.selectedPriceIndex === index) {
                this.selectedPriceIndex = null;
                this.selectedPrice = 0;

                // ÏÑ†ÌÉùÏù¥ Ìï¥Ï†úÎêòÎ©¥ ÏòàÏÉÅÍ∞ÄÍ≤©ÏóêÏÑú ÏÑ†ÌÉùÎêú Í∞ÄÍ≤©ÏùÑ Î∫ÄÎã§
                this.reserveVo.expectedPrice = 0;
            } else {
                // ÏÑ†ÌÉùÎêú Í∞ÄÍ≤©Ïù¥ ÏóÜÏùÑ Í≤ΩÏö∞ÏóêÎßå ÏÉàÎ°úÏö¥ Í∞ÄÍ≤©ÏùÑ ÏÑ†ÌÉù
                // Ïù¥Ï†ÑÏóê ÏÑ†ÌÉùÎêú Í∞ÄÍ≤©Ïù¥ ÏûàÏóàÎã§Î©¥, Î®ºÏ†Ä Í∑∏ Í∞ÄÍ≤©ÏùÑ ÏòàÏÉÅÍ∞ÄÍ≤©ÏóêÏÑú ÎπºÏ§ÄÎã§
                if (this.selectedPriceIndex !== null) {
                    this.reserveVo.expectedPrice = 0;
                }

                // ÏÉàÎ°úÏö¥ Í∞ÄÍ≤©ÏùÑ ÏòàÏÉÅÍ∞ÄÍ≤©Ïóê Ï∂îÍ∞Ä
                this.reserveVo.expectedPrice += price;
                this.selectedPriceIndex = index;
                this.selectedPrice = price; // ÏÑ†ÌÉùÎêú Í∞ÄÍ≤© ÏóÖÎç∞Ïù¥Ìä∏

                // priceVoÏóê Îã¥Í∏∞
                this.priceVo.onePrice = price;
                this.priceVo.weightDiv = thValue;
                this.priceVo.beauty = firstThValue;


                // firstThValueÏôÄ thValueÏóê ÎßûÎäî priceNo Í∞íÏùÑ priceListÏóêÏÑú Ï∞æÍ∏∞
                this.priceList.forEach(item => {
                    if (item.beauty === firstThValue && item.weightDiv === thValue) {
                        console.log("Í∞ÄÍ≤©Ìëú No:", item.priceNo);
                        this.priceVo.priceNo = item.priceNo;
                        console.log("Í∞ÄÍ≤©ÌëúÎßûÏïÑ??????????????");
                        console.log(this.priceVo.priceNo);
                    }
                });
            }

            // priceList2 Î∞∞Ïó¥Ïùò Î™®Îì† ÏöîÏÜåÏùò selected ÏÜçÏÑ±ÏùÑ Ï¥àÍ∏∞Ìôî
            this.priceList2.forEach(item => {
                item.selected = false;
            });
        },


        // Ìè¨Ïù∏Ìä∏ Ï†ÑÏï°ÏÇ¨Ïö© Î≤ÑÌäº
        useAllPoint() {
            this.usePoint = this.uPoint;
        },


        // Ïú†Ï†ÄÌè¨Ïù∏Ìä∏
        getPoint() {
            console.log("Ïú†Ï†ÄÌè¨Ïù∏Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞");
            axios({
                method: 'get',  //put,post,delete
                url: `${this.$store.state.apiBaseUrl}/api/mypage/getpoint`,
                headers: { "Content-Type": "application/json; charset=utf-8" }, //Ï†ÑÏÜ°ÌÉÄÏûÖ
                params: { uNo: this.dogVo.uNo },
                responseType: 'json' //ÏàòÏã†ÌÉÄÏûÖ
            }).then(response => {
                console.log("Ïú†Ï†ÄÌè¨Ïù∏Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞");
                console.log(response.data.apiData); //ÏàòÏã†Îç∞Ïù¥ÌÉÄ
                this.uPoint = response.data.apiData.uPoint;
            }).catch(error => {
                console.log(error);
            });
        },

        // Í≤∞Ï†úÎ∞©Î≤ï Î≤ÑÌäº
        togglePayment(index) {
            // Ïù¥ÎØ∏ ÏÑ†ÌÉùÎêú Í≤∞Ï†ú Î∞©Î≤ïÏù¥ÎùºÎ©¥ ÏÑ†ÌÉù Ï∑®ÏÜåÌïòÍ≥†, ÏïÑÎãàÎùºÎ©¥ ÏÑ†ÌÉùÌï©ÎãàÎã§.
            this.selectedPayment = this.selectedPayment === index ? null : index;
        },

        ...mapActions(['updateReservationData']),

        // ÏòàÏïΩÌïòÍ∏∞
        reserveInsert() {
            console.log(this.uNo);
            console.log(this.bNo);
            const formData = new FormData();

            // ÏÑúÎ™ÖÏù¥ ÎπÑÏñ¥ ÏûàÎäîÏßÄ ÌôïÏù∏
            const canvas = this.$refs.signatureCanvas;
            const context = canvas.getContext('2d');
            const imageData = context.getImageData(0, 0, canvas.width, canvas.height).data;
            const isEmpty = imageData.every(channel => channel === 0);

            if (!this.reserveVo.rtDate || !this.reserveVo.rtTime) {
                alert('ÎÇ†ÏßúÏôÄ ÏãúÍ∞ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
            } else if (this.reserveVo.expectedPrice == 0) {
                alert("Î∞òÎ†§Í≤¨ÏùÑ ÏÑ†ÌÉùÌïòÏó¨ ÏòàÏïΩÌï† Î™©Î°ùÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.");
            }
            // else if (!document.getElementById('agreeCheckbox').checked) {
            //     alert('ÏïàÎÇ¥ÏÇ¨Ìï≠ Î∞è ÎØ∏Ïö©Ïãú Ï£ºÏùòÏÇ¨Ìï≠Ïóê ÎèôÏùòÌï¥Ï£ºÏÑ∏Ïöî.');
            // } 
            else if (isEmpty) {
                alert("ÏÑúÎ™ÖÏùÑ Ìï¥Ï£ºÏÑ∏Ïöî.");
            } else {
                // CanvasÎ•º Ïù¥ÎØ∏ÏßÄ ÌååÏùºÎ°ú Î≥ÄÌôòÌïòÏó¨ FormDataÏóê Ï∂îÍ∞Ä
                const dataURL = canvas.toDataURL(); // CanvasÎ•º Data URLÎ°ú Î≥ÄÌôò
                const blob = this.dataURItoBlob(dataURL); // Data URLÏùÑ BlobÏúºÎ°ú Î≥ÄÌôò

                // BlobÏùÑ File Í∞ùÏ≤¥Î°ú Î≥ÄÌôò
                const imageFile = new File([blob], 'signature.png', { type: 'image/png' });


                // FormDataÏóê Ïù¥ÎØ∏ÏßÄ ÌååÏùº Ï∂îÍ∞Ä
                formData.append('signFile', imageFile);

                // ÏòàÏïΩÏóê ÌïÑÏöîÌïú Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä
                formData.append('rtDate', this.reserveVo.rtDate); 
                formData.append('rtTime', this.reserveVo.rtTime); 
                formData.append('dogNo', this.dogVo.dogNo); 
                formData.append('skin', this.dogVo.skin); 
                formData.append('heart', this.dogVo.heart); 
                formData.append('marking', this.dogVo.marking); 
                formData.append('mounting', this.dogVo.mounting);
                formData.append('bite', this.dogVo.bite); 
                formData.append('memo', this.dogVo.memo);
                formData.append('beauty', this.priceVo.beauty); 
                formData.append('onePrice', this.priceVo.onePrice); 
                formData.append('weightDiv', this.priceVo.weightDiv); 
                formData.append('expectedPrice', this.reserveVo.expectedPrice);
                formData.append('usePoint', this.usePoint);
                formData.append('bNo', this.reserveVo.bNo);
                formData.append('uNo', this.uNo);
                formData.append('rtNo', this.reserveVo.rtNo);
                formData.append('rtFinish', this.reserveVo.rtFinish);
                formData.append('priceNo', this.priceVo.priceNo); 
                formData.append('rsNo', this.reserveVo.rsNo);
                formData.append('bNo', this.bNo);

                this.priceVo.priceNo2.forEach((item, index) => {
                    formData.append(`priceNoPlus[${index}]`, item);
                });
                console.log("ÏòàÏïΩÏ†úÎ∞îÏïÑÏïÑÏïÑÏïÑÏïÑÏïÑÏïÑÏïÑÏïå");

                // ÏòàÏïΩÏóê ÌïÑÏöîÌïú Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä
                const reservationData = {
                    rtDate: this.reserveVo.rtDate,
                    rtTime: this.reserveVo.rtTime,
                    dogNo: this.dogVo.dogNo,
                    skin: this.dogVo.skin,
                    heart: this.dogVo.heart,
                    marking: this.dogVo.marking,
                    mounting: this.dogVo.mounting,
                    bite: this.dogVo.bite,
                    memo: this.dogVo.memo,
                    beauty: this.priceVo.beauty,
                    onePrice: this.priceVo.onePrice,
                    weightDiv: this.priceVo.weightDiv,
                    expectedPrice: this.reserveVo.expectedPrice,
                    usePoint: this.usePoint,
                    bNo: this.reserveVo.bNo,
                    uNo: this.uNo,
                    rtNo: this.reserveVo.rtNo,
                    rtFinish: this.reserveVo.rtFinish,
                    priceNo: this.priceVo.priceNo,
                    rsNum: this.reserveVo.rsNo,
                    priceNoPlus: this.priceVo.priceNo2,
                    title: this.businessVo.title,
                    dogName: this.dogVo.dogName,
                    beauty2: this.priceVo.beauty2,
                    bPhone: this.businessVo.bPhone,
                    bAddress: this.businessVo.bAddress,
                    bdAddress: this.businessVo.bdAddress,
                    saveName: this.businessVo.saveName

                };

                // Vuex Ïä§ÌÜ†Ïñ¥Ïóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                this.updateReservationData(reservationData);

                axios({
                    method: 'post',
                    url: `${this.$store.state.apiBaseUrl}/api/mypage/reservation`,
                    headers: { "Content-Type": "multipart/form-data" },
                    data: formData,
                    responseType: 'json'
                }).then(response => {
                    console.log(response.data);
                    if (response.data.result == "success") {
                        console.log("ÏòàÏïΩÌïòÍ∏∞ÏÑ±Í≥µ!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");

                        this.$router.push('/reservationsuccess');




                    } else {
                        alert("ÏïåÏàòÏóÜÎäî Ïò§Î•ò");
                    }
                }).catch(error => {
                    console.log(error);
                });
            }
        },


        // Ï†ÑÏûêÏÑúÎ™Ö Blob
        dataURItoBlob(dataURI) {
            const byteString = atob(dataURI.split(',')[1]);
            const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
            const ab = new ArrayBuffer(byteString.length);
            const ia = new Uint8Array(ab);
            for (let i = 0; i < byteString.length; i++) {
                ia[i] = byteString.charCodeAt(i);
            }
            return new Blob([ab], { type: mimeString });
        },

        clearCanvas() {
            const canvas = this.$refs.signatureCanvas;
            if (canvas) {
                const context = canvas.getContext('2d');
                context.clearRect(0, 0, canvas.width, canvas.height);
            }
        },
        onBegin() {
            if (this.signaturePad) {
                this.signaturePad.onBegin();
            }
        },
        onEnd() {
            if (this.signaturePad) {
                this.signaturePad.onEnd();
            }
        },
        getSignatureImage() {
            // ÏÑúÎ™ÖÏù¥ ÏûÖÎ†•ÎêòÏßÄ ÏïäÏïòÏùÑ Îïå Îπà Î¨∏ÏûêÏó¥ Î∞òÌôò
            if (this.signaturePad.isEmpty()) {
                return '';
            }

            // ÏÑúÎ™ÖÏùÑ Ïù¥ÎØ∏ÏßÄÎ°ú Î≥ÄÌôòÌïòÏó¨ Î∞òÌôò
            return this.signaturePad.toDataURL();
        }
        ,

        initSignaturePad() {
            this.$nextTick(() => {
                const canvas = this.$refs.signatureCanvas;
                if (canvas) {
                    this.signaturePad = new SignaturePad(canvas);
                } else {
                    console.error('Canvas element not found');
                }
            });
        },



    },

    mounted() {
        if (this.currentStep == 4) {
            this.initSignaturePad();
            const canvas = this.$refs.signatureCanvas;
            this.signaturePad = new SignaturePad(canvas);
        }
    },

    created() {
        this.getBList();
        this.getPetList();
        this.getPoint();
    }
};
</script>

<style>
#reservationForm .selected {
    background-color: #236C3F !important;
    color: #ffffff !important;
}

canvas {
    border: 1px solid #a7a4a4;
    width: 875px;
    height: 250px;
    border-radius: 10px;
}

.sign0 {
    width: 875px;
    /* background-color: red; */
    text-align: end;
}

.sign0 button {
    border: 1px solid gray;
    border-radius: 5px;
    padding: 5px;
    cursor: pointer;
}
</style>
